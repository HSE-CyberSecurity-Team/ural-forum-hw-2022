<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- force IE browsers in compatibility mode to use their most aggressive rendering engine -->

    <meta charset="UTF-8">
    <title>hORIzON Status </title>
    <meta name="description" content="Welcome to hORIzOn Team Web App&#39;s home for real-time and historical monitoring data.">

    <!-- Mobile viewport optimization h5bp.com/ad -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">

    <!-- Time this page was rendered - http://purl.org/dc/terms/issued -->
    <meta name="issued" content="1649098902">

    <!-- Mobile IE allows us to activate ClearType technology for smoothing fonts for easy reading -->
    <meta http-equiv="cleartype" content="on">


    <link rel="shortcut icon" type="image/x-icon" href="static/logo-ico.ico" />

    <link rel="shortcut icon" href='logo-ico.ico'>

    <script>
        function service_elems(id, d) {
            // var link = document.createElement('div');
            // link.id = 'link_' + String(id);
            // link.innerHTML = "<input type=\"text\" style=\"width: 100%; visibility: visible;\" placeholder=\"Input a link to the service (e.g. https://www.google.com/)\">";
            // var name = document.createElement('div');
            // name.id= 'link_' + String(id);
            // name.innerHTML = "<input type=\"text\" style=\"width: 100%; visibility: visible;\" placeholder=\"Input a name of the service (e.g. google/)\">";
            // var button = document.createElement('div');
            // button.id= 'button_' + String(id);
            // button.innerHTML = "<input type=\"button\" value=\"Add\" style=\"width:100%;color:white;background-color:#4c9aff;visibility:hidden;\" onclick=\"addService()\">\n";
            var form = document.createElement("form"+id);
            // form.setAttribute("method", "post");
            // form.setAttribute("action", "submit.php");

            // Create an input element for emailID
            var name = document.createElement("input");
            name.setAttribute("value", d["name"])
            name.setAttribute("type", "text");
            name.setAttribute("name", "serviceName"+id);
            name.setAttribute("placeholder", "serviceName"+id);

            // Create an input element for password
            var url = document.createElement("input");
            url.setAttribute("value", d["url"])
            url.setAttribute("type", "text");
            url.setAttribute("name", "service_url_"+id);
            url.setAttribute("placeholder", "service_url_"+id);

            // Create a submit button
            var button = document.createElement("button");
            button.setAttribute("name", "button_"+id);
            // s.setAttribute("value", "Submit");

            // Append the email_ID input to the form
            form.append(name);
            form.append(url);
            form.append(button);

            document.getElementsByClassName("timeframes-container")[0].appendChild(form);
            // document.getElementById("text1").style.visibility = "visible";

            // document.getElementById("pushMe2").style.visibility = "visible";
            // return [link, name, button]
        }

        function get_apps(){
            $.ajax
            ({
                type: "GET",
                url: 'http://127.0.0.1:8000/app_lists',
                contentType:"application/json; charset=utf-8",
                // headers: {"Access-Control-Allow-Origin":"*"},
                // dataType: 'json',

                // async: false,
                // data: '{"name": "' + document.getElementById("text1").value + '", "url" : "' + document.getElementById("text1").value + '", "active" : "true"}',
                success: function (d) {
                    // console.log(d)
                    alert(JSON.stringify(d));
                    let container = document.getElementById("timeframes-container")
                    for (var i = 0; i < d.length; i++){
                        // let elems = service_elems(i);
                        // console.log(elems)
                        // container.appendChild(elems[0]);
                        // container.appendChild(elems[1]);
                        // container.appendChild(elems[2]);
                        service_elems(i, d[i]);
                    }
                },
                error: function (e){
                  alert('lol')
                }
            })
        }
        function get_health(app){
            $.ajax
            ({
                type: "GET",
                url: 'http://127.0.0.1:8000/health/' + app,
                contentType:"application/json; charset=utf-8",
                // headers: {"Access-Control-Allow-Origin":"*"},
                // dataType: 'json',

                // async: false,
                // data: '{"name": "' + document.getElementById("text1").value + '", "url" : "' + document.getElementById("text1").value + '", "active" : "true"}',
                success: function (d) {
                    // console.log(d)
                    alert(JSON.stringify(d));

                },
                error: function (e){
                  alert('error')
                }
            })
        }


        // get_apps()
        window.onload = get_apps;
        function addService() {

            var tmp = document.getElementById("text1").value;

            // alert("Meow")
            if(document.getElementById("text1").value.length == 0)
            {
                document.getElementById("text1").value = "Oops, blank input...";
                alert("Поле пустое - пожалуйста, введите ссылку на cервис")
            } else {
                // let container = document.getElementById("timeframes-container")

                let buttonClass = document.createElement('div')
                const button = document.createElement('button');
                button.classList.add('btn');
                button.textContent = tmp;
                buttonClass.appendChild(button);

                $.ajax
                ({
                    type: "POST",
                    url: 'http://127.0.0.1:8000/add',
                    contentType:"application/json; charset=utf-8",
                    // headers: {"Access-Control-Allow-Origin":"*"},
                    dataType: 'json',

                    async: false,
                    data: '{"name": "' + document.getElementById("text1").value + '", "url" : "' + document.getElementById("text1").value + '", "active" : "true"}',
                    success: function (data) {

                        // alert("Thanks!");
                        if (data === "app already exists"){
                            get_health(document.getElementById("text1").value)
                        }

                    }
                })

            }

        }
    </script>

    <!-- Le styles -->
    <link rel="stylesheet" media="screen" href="static/0.763ab44e660250f88ee6.css" />
    <link rel="stylesheet" media="all" href="static/status_manifest-08a0ce5b8cccd461963af5bf415c8d59b4d24d4fe74d8f6d3661643cb959f919.css" />

    <script src="static/jquery-3.5.1.min-729e416557a365062a8a20f0562f18aa171da57298005d392312670c706c68de.js"></script>

    <script>
        window.pageColorData = {"blue":"#3498DB","border":"#E0E0E0","body_background":"#FFFFFF","font":"#2E3338","graph":"#5865F2","green":"#3BA55C","light_font":"#72767D","link":"#5865F2","orange":"#F26522","red":"#ED4245","yellow":"#CB8615","no_data":"#B3BAC5"};
    </script>
    <style>
        /* BODY BACKGROUND */ /* BODY BACKGROUND */ /* BODY BACKGROUND */ /* BODY BACKGROUND */ /* BODY BACKGROUND */
        body,
        .layout-content.status.status-api .section .example-container .example-opener .color-secondary,
        .grouped-items-selector,
        .layout-content.status.status-full-history .history-nav a.current,
        div[id^="subscribe-modal"] .modal-footer,
        div[id^="subscribe-modal"],
        #uptime-tooltip .tooltip-box {
            background-color:#FFFFFF;
        }

        #uptime-tooltip .pointer-container .pointer-smaller {
            border-bottom-color:#FFFFFF;
        }


        /* PRIMARY FONT COLOR */ /* PRIMARY FONT COLOR */ /* PRIMARY FONT COLOR */ /* PRIMARY FONT COLOR */
        body.status,
        .color-primary,
        .color-primary:hover,
        .layout-content.status-index .status-day .update-title.impact-none a,
        .layout-content.status-index .status-day .update-title.impact-none a:hover,
        .layout-content.status-index .timeframes-container .timeframe.active,
        .layout-content.status-full-history .month .incident-container .impact-none,
        .layout-content.status.status-index .incidents-list .incident-title.impact-none a,
        .incident-history .impact-none,
        .layout-content.status .grouped-items-selector.inline .grouped-item.active,
        .layout-content.status.status-full-history .history-nav a.current,
        .layout-content.status.status-full-history .history-nav a:not(.current):hover,
        div[id^="subscribe-modal"] .modal-header .close,
        .grouped-item-label,
        #uptime-tooltip .tooltip-box .tooltip-content .related-events .related-event a.related-event-link {
            color:#2E3338;
        }

        .layout-content.status.status-index .components-statuses .component-container .name {
            color:#2E3338;
            color:rgba(46,51,56,.8);
        }




        /* SECONDARY FONT COLOR */ /* SECONDARY FONT COLOR */ /* SECONDARY FONT COLOR */ /* SECONDARY FONT COLOR */
        small,
        .layout-content.status .table-row .date,
        .color-secondary,
        .layout-content.status .grouped-items-selector.inline .grouped-item,
        .layout-content.status.status-full-history .history-footer .pagination a.disabled,
        .layout-content.status.status-full-history .history-nav a,
        #uptime-tooltip .tooltip-box .tooltip-content .related-events #related-event-header {
            color:#72767D;
        }




        /* BORDER COLOR */  /* BORDER COLOR */  /* BORDER COLOR */  /* BORDER COLOR */  /* BORDER COLOR */  /* BORDER COLOR */
        body.status .layout-content.status .border-color,
        hr,
        .tooltip-base,
        .markdown-display table,
        div[id^="subscribe-modal"],
        #uptime-tooltip .tooltip-box {
            border-color:#E0E0E0;
        }

        div[id^="subscribe-modal"] .modal-footer,
        .markdown-display table td {
            border-top-color:#E0E0E0;
        }

        div[id^="subscribe-modal"] .modal-header .close:hover {
            color:#E0E0E0;
        }

        .markdown-display table td + td, .markdown-display table th + th {
            border-left-color:#E0E0E0;
        }

        div[id^="subscribe-modal"] .modal-header,
        #uptime-tooltip .pointer-container .pointer-larger {
            border-bottom-color:#E0E0E0;
        }

        #uptime-tooltip .tooltip-box .outage-field {
            /*
              Generate the background-color for the outage-field from the css_body_background_color and css_border_color.

              For the default background (#ffffff) and default css_border_color (#e0e0e0), use the luminosity of the default background with a magic number to arrive at
              the original outage-field background color (#f4f5f7). I used the formula Target Color = Color * alpha + Background * (1 - alpha) to find the magic number of ~0.08.

              For darker css_body_background_color, luminosity values are lower so alpha trends toward becoming transparent (thus outage-field background becomes same as css_body_background_color).
            */
            background-color: rgba(224,224,224,0.31);

            /*
              outage-field border-color alpha is inverse to the luminosity of css_body_background_color.
              That is to say, with a default white background this border is transparent, but on a black background, it's opaque css_border_color.
            */
            border-color: rgba(224,224,224,0.0);
        }




        /* CSS REDS */ /* CSS REDS */ /* CSS REDS */ /* CSS REDS */ /* CSS REDS */ /* CSS REDS */ /* CSS REDS */
        .layout-content.status.status-index .status-day .update-title.impact-critical a,
        .layout-content.status.status-index .status-day .update-title.impact-critical a:hover,
        .layout-content.status.status-index .page-status.status-critical,
        .layout-content.status.status-index .unresolved-incident.impact-critical .incident-title,
        .flat-button.background-red {
            background-color:#ED4245;
        }

        .layout-content.status-index .components-statuses .component-container.status-red:after,
        .layout-content.status-full-history .month .incident-container .impact-critical,
        .layout-content.status-incident .incident-name.impact-critical,
        .layout-content.status.status-index .incidents-list .incident-title.impact-critical a,
        .status-red .icon-indicator,
        .incident-history .impact-critical,
        .components-container .component-inner-container.status-red .component-status,
        .components-container .component-inner-container.status-red .icon-indicator {
            color:#ED4245;
        }

        .layout-content.status.status-index .unresolved-incident.impact-critical .updates {
            border-color:#ED4245;
        }




        /* CSS ORANGES */ /* CSS ORANGES */ /* CSS ORANGES */ /* CSS ORANGES */ /* CSS ORANGES */ /* CSS ORANGES */
        .layout-content.status.status-index .status-day .update-title.impact-major a,
        .layout-content.status.status-index .status-day .update-title.impact-major a:hover,
        .layout-content.status.status-index .page-status.status-major,
        .layout-content.status.status-index .unresolved-incident.impact-major .incident-title {
            background-color:#F26522;
        }

        .layout-content.status-index .components-statuses .component-container.status-orange:after,
        .layout-content.status-full-history .month .incident-container .impact-major,
        .layout-content.status-incident .incident-name.impact-major,
        .layout-content.status.status-index .incidents-list .incident-title.impact-major a,
        .status-orange .icon-indicator,
        .incident-history .impact-major,
        .components-container .component-inner-container.status-orange .component-status,
        .components-container .component-inner-container.status-orange .icon-indicator {
            color:#F26522;
        }

        .layout-content.status.status-index .unresolved-incident.impact-major .updates {
            border-color:#F26522;
        }




        /* CSS YELLOWS */ /* CSS YELLOWS */ /* CSS YELLOWS */ /* CSS YELLOWS */ /* CSS YELLOWS */ /* CSS YELLOWS */
        .layout-content.status.status-index .status-day .update-title.impact-minor a,
        .layout-content.status.status-index .status-day .update-title.impact-minor a:hover,
        .layout-content.status.status-index .page-status.status-minor,
        .layout-content.status.status-index .unresolved-incident.impact-minor .incident-title,
        .layout-content.status.status-index .scheduled-incidents-container .tab {
            background-color:#CB8615;
        }

        .layout-content.status-index .components-statuses .component-container.status-yellow:after,
        .layout-content.status-full-history .month .incident-container .impact-minor,
        .layout-content.status-incident .incident-name.impact-minor,
        .layout-content.status.status-index .incidents-list .incident-title.impact-minor a,
        .status-yellow .icon-indicator,
        .incident-history .impact-minor,
        .components-container .component-inner-container.status-yellow .component-status,
        .components-container .component-inner-container.status-yellow .icon-indicator,
        .layout-content.status.manage-subscriptions .confirmation-infobox .fa {
            color:#CB8615;
        }

        .layout-content.status.status-index .unresolved-incident.impact-minor .updates,
        .layout-content.status.status-index .scheduled-incidents-container {
            border-color:#CB8615;
        }




        /* CSS BLUES */ /* CSS BLUES */ /* CSS BLUES */ /* CSS BLUES */ /* CSS BLUES */ /* CSS BLUES */
        .layout-content.status.status-index .status-day .update-title.impact-maintenance a,
        .layout-content.status.status-index .status-day .update-title.impact-maintenance a:hover,
        .layout-content.status.status-index .page-status.status-maintenance,
        .layout-content.status.status-index .unresolved-incident.impact-maintenance .incident-title,
        .layout-content.status.status-index .scheduled-incidents-container .tab {
            background-color:#3498DB;
        }

        .layout-content.status-index .components-statuses .component-container.status-blue:after,
        .layout-content.status-full-history .month .incident-container .impact-maintenance,
        .layout-content.status-incident .incident-name.impact-maintenance,
        .layout-content.status.status-index .incidents-list .incident-title.impact-maintenance a,
        .status-blue .icon-indicator,
        .incident-history .impact-maintenance,
        .components-container .component-inner-container.status-blue .component-status,
        .components-container .component-inner-container.status-blue .icon-indicator {
            color:#3498DB;
        }

        .layout-content.status.status-index .unresolved-incident.impact-maintenance .updates,
        .layout-content.status.status-index .scheduled-incidents-container {
            border-color:#3498DB;
        }




        /* CSS GREENS */ /* CSS GREENS */ /* CSS GREENS */ /* CSS GREENS */ /* CSS GREENS */ /* CSS GREENS */ /* CSS GREENS */
        .layout-content.status.status-index .page-status.status-none {
            background-color:#3BA55C;
        }
        .layout-content.status-index .components-statuses .component-container.status-green:after,
        .status-green .icon-indicator,
        .components-container .component-inner-container.status-green .component-status,
        .components-container .component-inner-container.status-green .icon-indicator {
            color:#3BA55C;
        }



        /* CSS LINK COLOR */  /* CSS LINK COLOR */  /* CSS LINK COLOR */  /* CSS LINK COLOR */  /* CSS LINK COLOR */  /* CSS LINK COLOR */
        a,
        a:hover,
        .layout-content.status-index .page-footer span a:hover,
        .layout-content.status-index .timeframes-container .timeframe:not(.active):hover,
        .layout-content.status-incident .subheader a:hover {
            color:#5865F2;
        }

        .flat-button,
        .masthead .updates-dropdown-container .show-updates-dropdown,
        .layout-content.status-full-history .show-filter.open  {
            background-color:#5865F2;
        }




        /* CUSTOM COLOR OVERRIDES FOR UPTIME SHOWCASE */
        .components-section .components-uptime-link {
            color: #72767d;
        }

        .layout-content.status .shared-partial.uptime-90-days-wrapper .legend .legend-item {
            color: #72767d;
            opacity: 0.8;
        }
        .layout-content.status .shared-partial.uptime-90-days-wrapper .legend .legend-item.light {
            color: #72767d;
            opacity: 0.5;
        }
        .layout-content.status .shared-partial.uptime-90-days-wrapper .legend .spacer {
            background: #72767d;
            opacity: 0.3;
        }

        .wrapper {
            display: flex;
        }
        .services {
            float: left;
            width: 30%;
            height: 100%;
        }
        .container {
            float:right;
            width: 70%;
            height: 100%;
        }

    </style>


    <!-- custom css -->
    <link rel="stylesheet" type="text/css" href="static/external20211005-40-12abxbc.css">

    <!-- polyfills -->
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

    <!-- Le HTML5 shim -->
    <!--[if lt IE 9]>
    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- injection for static -->



</head>


<body class="status index status-none">




<div class="layout-content status status-index starter">
    <div class="masthead-container basic">

        <div class="masthead has-logo">
            <div class="logo-container">
                <a href="https://github.com/HSE-CyberSecurity-Team"><img src="static/logo-full.png"
                                                   width="500"/></a>
            </div>

        </div>

    </div>
    <!-- this is outside of the .container so that the cover photo can go full width on mobile -->
<div class="wrapper">
    <div class="services" style="margin-left:50px;margin-right:25px; ">
        <div class="page-status status-none">
          <span class="status font-large">
            Service List
          </span>

        </div>

        <div class="menu-container" id="menu-container">
            <input id="pushMe" type="button" value="Add New Service" style="margin-bottom:10px; width:100%;color:white;background-color:#4c9aff;" onclick="showAddMenu()" >
            <div class="timeframes-container">
                <div class="service-field" style="width:100%;visibility:hidden;">
                    <input id="text1" type="text" style="width:100%; " placeholder="Input a link to the service (e.g. https://www.google.com/)">
                </div>
                <!-- <a href="#" class="timeframe color-secondary font-regular border-color" data-js-hook="data-time-period-toggle" data-time-period="month">Add New Service</a>-->
                <input id="pushMe2" type="button" value="Add" style="width:100%;color:white;background-color:#4c9aff;visibility:hidden;" onclick="addService()">
            </div>
            <div class="metrics-container">
                <div class="metric border-color">
                    <div class="metric-meta font-large">
                        <div class="metric-name color-primary">
                            .....................
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="margin-right:50px;">

        <div class="page-status status-none">
          <span class="status font-large">
            Service Operational
          </span>
            <span class="last-updated-stamp  font-small"></span>
        </div>

        <div class="custom-metrics-container" id="custom-metrics-container">
            <div class="timeframes-container">
                <a class="font-largest no-link" id="system-metrics" href="#system-metrics">Service Metrics</a>
                <a href="#" class="timeframe color-secondary font-regular border-color" data-js-hook="data-time-period-toggle" data-time-period="month">Month</a>
                <a href="#" class="timeframe color-secondary font-regular border-color" data-js-hook="data-time-period-toggle" data-time-period="week"><span class="translation_missing" title="translation missing: en.week">Week</span></a>
                <a href="#" class="timeframe active color-secondary font-regular border-color" data-js-hook="data-time-period-toggle" data-time-period="day">Day</a>
            </div>
            <div class="metrics-container">
                <div class="metric border-color">
                    <div class="metric-meta font-large">
                        <div class="metric-name color-primary">
                            API Response Time
                        </div>

                        <div data-js-hook="metrics-display-current-5k2rt9f7pmny" class="metric-average color-secondary"><span class="translation_missing" title="translation missing: en.fetching">Fetching</span></div>
                    </div>
                    <div class="metrics-display-graph">
                        <div class="graph-container" id="metrics-display-graph-container-5k2rt9f7pmny" data-js-hook= "metrics-display-graph-container-5k2rt9f7pmny"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="components-section font-regular">
            <i class="component-status hidden major_outage"></i>
            <div class="components-uptime-link history-footer-link">
                Uptime over the past <var data-var="num" data-pluralize="90">90</var> days. <a href="/uptime">View historical uptime.</a>
            </div>
            <div class="components-container one-column">
                <div class="component-container border-color">

                    <div data-component-id="rhznvxg4v7yh"
                         class="component-inner-container status-green showcased"
                         data-component-status="operational"
                         data-js-hook="">

   <span class="name">
      API
   </span>

                        <span class="tooltip-base tool" title="The API is responsible for sending and receiving messages, and general operations on the platform. If this is down, chances are you&amp;apos;ll have trouble connecting and/or sending messages.">?</span>

                        <span
                                class="component-status "
                                title=""
                        >

    Operational

  </span>

                        <span class="tool icon-indicator fa fa-check" title="Operational"></span>

                        <div class="shared-partial uptime-90-days-wrapper">
                            <svg class="availability-time-line-graphic" id="uptime-component-rhznvxg4v7yh" preserveAspectRatio="none" height="34" viewBox="0 0 448 34">

                                <rect height="34" width="3" x="0" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-0" data-html="true" />
                                <rect height="34" width="3" x="5" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-1" data-html="true" />
                                <rect height="34" width="3" x="10" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-2" data-html="true" />
                                <rect height="34" width="3" x="15" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-3" data-html="true" />
                                <rect height="34" width="3" x="20" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-4" data-html="true" />
                                <rect height="34" width="3" x="25" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-5" data-html="true" />
                                <rect height="34" width="3" x="30" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-6" data-html="true" />
                                <rect height="34" width="3" x="35" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-7" data-html="true" />
                                <rect height="34" width="3" x="40" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-8" data-html="true" />
                                <rect height="34" width="3" x="45" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-9" data-html="true" />
                                <rect height="34" width="3" x="50" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-10" data-html="true" />
                                <rect height="34" width="3" x="55" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-11" data-html="true" />
                                <rect height="34" width="3" x="60" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-12" data-html="true" />
                                <rect height="34" width="3" x="65" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-13" data-html="true" />
                                <rect height="34" width="3" x="70" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-14" data-html="true" />
                                <rect height="34" width="3" x="75" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-15" data-html="true" />
                                <rect height="34" width="3" x="80" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-16" data-html="true" />
                                <rect height="34" width="3" x="85" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-17" data-html="true" />
                                <rect height="34" width="3" x="90" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-18" data-html="true" />
                                <rect height="34" width="3" x="95" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-19" data-html="true" />
                                <rect height="34" width="3" x="100" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-20" data-html="true" />
                                <rect height="34" width="3" x="105" y="0" fill="#ed4245" class="uptime-day component-rhznvxg4v7yh day-21" data-html="true" />
                                <rect height="34" width="3" x="110" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-22" data-html="true" />
                                <rect height="34" width="3" x="115" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-23" data-html="true" />
                                <rect height="34" width="3" x="120" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-24" data-html="true" />
                                <rect height="34" width="3" x="125" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-25" data-html="true" />
                                <rect height="34" width="3" x="130" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-26" data-html="true" />
                                <rect height="34" width="3" x="135" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-27" data-html="true" />
                                <rect height="34" width="3" x="140" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-28" data-html="true" />
                                <rect height="34" width="3" x="145" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-29" data-html="true" />
                                <rect height="34" width="3" x="150" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-30" data-html="true" />
                                <rect height="34" width="3" x="155" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-31" data-html="true" />
                                <rect height="34" width="3" x="160" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-32" data-html="true" />
                                <rect height="34" width="3" x="165" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-33" data-html="true" />
                                <rect height="34" width="3" x="170" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-34" data-html="true" />
                                <rect height="34" width="3" x="175" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-35" data-html="true" />
                                <rect height="34" width="3" x="180" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-36" data-html="true" />
                                <rect height="34" width="3" x="185" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-37" data-html="true" />
                                <rect height="34" width="3" x="190" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-38" data-html="true" />
                                <rect height="34" width="3" x="195" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-39" data-html="true" />
                                <rect height="34" width="3" x="200" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-40" data-html="true" />
                                <rect height="34" width="3" x="205" y="0" fill="#a78e27" class="uptime-day component-rhznvxg4v7yh day-41" data-html="true" />
                                <rect height="34" width="3" x="210" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-42" data-html="true" />
                                <rect height="34" width="3" x="215" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-43" data-html="true" />
                                <rect height="34" width="3" x="220" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-44" data-html="true" />
                                <rect height="34" width="3" x="225" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-45" data-html="true" />
                                <rect height="34" width="3" x="230" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-46" data-html="true" />
                                <rect height="34" width="3" x="235" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-47" data-html="true" />
                                <rect height="34" width="3" x="240" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-48" data-html="true" />
                                <rect height="34" width="3" x="245" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-49" data-html="true" />
                                <rect height="34" width="3" x="250" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-50" data-html="true" />
                                <rect height="34" width="3" x="255" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-51" data-html="true" />
                                <rect height="34" width="3" x="260" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-52" data-html="true" />
                                <rect height="34" width="3" x="265" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-53" data-html="true" />
                                <rect height="34" width="3" x="270" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-54" data-html="true" />
                                <rect height="34" width="3" x="275" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-55" data-html="true" />
                                <rect height="34" width="3" x="280" y="0" fill="#a58e28" class="uptime-day component-rhznvxg4v7yh day-56" data-html="true" />
                                <rect height="34" width="3" x="285" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-57" data-html="true" />
                                <rect height="34" width="3" x="290" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-58" data-html="true" />
                                <rect height="34" width="3" x="295" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-59" data-html="true" />
                                <rect height="34" width="3" x="300" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-60" data-html="true" />
                                <rect height="34" width="3" x="305" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-61" data-html="true" />
                                <rect height="34" width="3" x="310" y="0" fill="#ed4245" class="uptime-day component-rhznvxg4v7yh day-62" data-html="true" />
                                <rect height="34" width="3" x="315" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-63" data-html="true" />
                                <rect height="34" width="3" x="320" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-64" data-html="true" />
                                <rect height="34" width="3" x="325" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-65" data-html="true" />
                                <rect height="34" width="3" x="330" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-66" data-html="true" />
                                <rect height="34" width="3" x="335" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-67" data-html="true" />
                                <rect height="34" width="3" x="340" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-68" data-html="true" />
                                <rect height="34" width="3" x="345" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-69" data-html="true" />
                                <rect height="34" width="3" x="350" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-70" data-html="true" />
                                <rect height="34" width="3" x="355" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-71" data-html="true" />
                                <rect height="34" width="3" x="360" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-72" data-html="true" />
                                <rect height="34" width="3" x="365" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-73" data-html="true" />
                                <rect height="34" width="3" x="370" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-74" data-html="true" />
                                <rect height="34" width="3" x="375" y="0" fill="#a28f29" class="uptime-day component-rhznvxg4v7yh day-75" data-html="true" />
                                <rect height="34" width="3" x="380" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-76" data-html="true" />
                                <rect height="34" width="3" x="385" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-77" data-html="true" />
                                <rect height="34" width="3" x="390" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-78" data-html="true" />
                                <rect height="34" width="3" x="395" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-79" data-html="true" />
                                <rect height="34" width="3" x="400" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-80" data-html="true" />
                                <rect height="34" width="3" x="405" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-81" data-html="true" />
                                <rect height="34" width="3" x="410" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-82" data-html="true" />
                                <rect height="34" width="3" x="415" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-83" data-html="true" />
                                <rect height="34" width="3" x="420" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-84" data-html="true" />
                                <rect height="34" width="3" x="425" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-85" data-html="true" />
                                <rect height="34" width="3" x="430" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-86" data-html="true" />
                                <rect height="34" width="3" x="435" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-87" data-html="true" />
                                <rect height="34" width="3" x="440" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-88" data-html="true" />
                                <rect height="34" width="3" x="445" y="0" fill="#3ba55c" class="uptime-day component-rhznvxg4v7yh day-89" data-html="true" />
                            </svg>
                            <div class="legend ">
                                <div class="legend-item light legend-item-date-range">
                                    <span class="availability-time-line-legend-day-count">90</span> days ago
                                </div>
                                <div class="spacer"></div>
                                <div class="legend-item legend-item-uptime-value legend-item-3y468xdr1st2">
    <span id="uptime-percent-3y468xdr1st2">
      100.0
    </span>
                                    <var data-var="uptime-percent">% uptime</var>
                                </div>
                                <div class="spacer"></div>
                                <div class="legend-item light legend-item-date-range">Today</div>
                            </div>

                        </div>

                    </div>

                </div>
                <div class="component-container border-color is-group ">

                    <div data-component-id="jk03xttfcz9b"
                         class="component-inner-container status-green "
                         data-component-status="operational"
                         data-js-hook="component-group-opener">

   <span class="name">
       <span class="fa group-parent-indicator color-secondary font-small fa-plus-square-o" role="button" aria-expanded="false" aria-label="Toggle Third-party" tabindex="0"></span>
       <span>
         Third-party
       </span>
   </span>


                        <span
                                class="component-status tool"
                                title="Groups take on the status of their most degraded child component or service. Click to see the status of the individual children."
                        >

    Operational

  </span>

                        <span class="tool icon-indicator fa fa-check" title="Operational"></span>

                    </div>


                    <!-- children components -->
                    <div class="child-components-container ">

                        <div data-component-id="gvg1c6688r5y"
                             class="component-inner-container status-green "
                             data-component-status="operational"
                             data-js-hook="">

   <span class="name">
      CloudFlare
   </span>

                            <span class="tooltip-base tool" title="CloudFlare is our DDoS protection provider and proxies all of our traffic through their network.">?</span>

                            <span
                                    class="component-status "
                                    title=""
                            >

    Operational

  </span>

                            <span class="tool icon-indicator fa fa-check" title="Operational"></span>

                        </div>


                        <div data-component-id="2b4f947c43gg"
                             class="component-inner-container status-green "
                             data-component-status="operational"
                             data-js-hook="">

   <span class="name">
      Tax Calculation Service
   </span>


                            <span
                                    class="component-status "
                                    title=""
                            >

    Operational

  </span>

                            <span class="tool icon-indicator fa fa-check" title="Operational"></span>

                        </div>

                    </div>
                </div>

            </div>
            <div class="component-statuses-legend font-small">
                <div class="legend-item status-green">
                    <span class="icon-indicator fa fa-check"></span>
                    Operational
                </div>
                <div class="legend-item status-yellow">
                    <span class="icon-indicator fa fa-minus-square"></span>
                    Degraded Performance
                </div>
                <div class="legend-item status-orange">
                    <span class="icon-indicator fa fa-exclamation-triangle"></span>
                    Partial Outage
                </div>
                <div class="breaker"></div>
                <div class="legend-item status-red">
                    <span class="icon-indicator fa fa-times"></span>
                    Major Outage
                </div>
                <div class="legend-item status-blue">
                    <span class="icon-indicator fa fa-wrench"></span>
                    Maintenance
                </div>
            </div>

        </div>

        <script type="text/javascript" charset="utf-8">

            function calculateViewbox (dayCount, rectWidth, rectPadding) {
                var viewBox = [];
                if (dayCount === 90) {
                    viewBox.push(0);
                } else {
                    var offset = 90 - dayCount;
                    viewBox.push((offset * rectWidth) + (rectPadding * (offset))); // x origin
                }
                viewBox.push(0); // y origin
                viewBox.push((rectWidth * dayCount) + (rectPadding * (dayCount - 1))); // svg width
                viewBox.push(34); // svg height
                return viewBox.join(' ');
            }

            document.addEventListener('DOMContentLoaded', function () {

                var MAX_WIDTH_30_DAYS = 600,
                    MAX_WIDTH_60_DAYS = 1024,
                    svgs = document.getElementsByClassName('availability-time-line-graphic'),
                    rects = svgs[0].getElementsByTagName('rect'),
                    rectWidth = parseInt(rects[0].getAttribute('width')),
                    rectPadding = parseInt(rects[1].getAttribute('x')) - parseInt(rects[0].getAttribute('x')) - rectWidth,
                    throttled = false,
                    delay = 150,
                    timeoutId;

                function getKeyAndCount(width) {
                    if (width <= MAX_WIDTH_30_DAYS) {
                        return { dayCount: 30, uptimeKey: 'thirty'}
                    } else if (width <= MAX_WIDTH_60_DAYS) {
                        return { dayCount: 60, uptimeKey: 'sixty'}
                    } else {
                        return { dayCount: 90, uptimeKey: 'ninety'}
                    }
                }

                function setUptimeValue(values, uptimeKey) {
                    var queryID = '.legend-item-' + values.component;
                    var currentUptime = document.querySelector(queryID);
                    if (currentUptime) {
                        // Faster than setting innerHTML to "" then adding nodes
                        var clone = currentUptime.cloneNode(false);
                        var uptimeSpan = document.createElement('span');
                        uptimeSpan.id = 'uptime-percent-' + values.component
                        uptimeSpan.innerText = values[uptimeKey]
                        clone.appendChild(uptimeSpan);
                        var appendText = document.createTextNode(' % uptime');
                        clone.appendChild(appendText);
                        currentUptime.parentNode.replaceChild(clone, currentUptime);
                    }
                }

                function setDayCount(el, dayCount) {
                    // Faster than setting innerHTML to "" then adding nodes
                    var clone = el.cloneNode(false);
                    var dateSpan = document.createElement('span')
                    dateSpan.className = "availability-time-line-legend-day-count"
                    dateSpan.innerText= dayCount;
                    clone.appendChild(dateSpan);
                    var appendText = document.createTextNode(' days ago');
                    clone.appendChild(appendText);
                    el.parentNode.replaceChild(clone, el);
                }

                function resizeSvgViewBoxes () {
                    var width = window.innerWidth;
                    var columnInfo = getKeyAndCount(width);
                    var dayCount = columnInfo.dayCount,
                        uptimeKey = columnInfo.uptimeKey;
                    var newViewboxValue = calculateViewbox(dayCount, rectWidth, rectPadding);

                    // If a user quickly resizes from < 450 to > 900 without stopping,
                    // it will retain the same 30 day info as it wont have changed, but this only
                    // impacts 30 day display as it is the only one with shortened text
                    if (newViewboxValue !== svgs[0].getAttribute('viewBox')) {
                        for (var i = 0; i < svgs.length; i++) {
                            var el = svgs[i];
                            if (el.getAttribute('viewBox') !== newViewboxValue) {
                                el.setAttribute('viewBox', newViewboxValue);
                            }
                        }

                        var dayCountElements = document.querySelectorAll('.legend-item-date-range:first-of-type');

                        for (var i = 0; i < dayCountElements.length; i++) {
                            setDayCount(dayCountElements[i], dayCount);
                        }

                        uptimeValues = [{"component":"rhznvxg4v7yh","ninety":99.77,"sixty":99.84,"thirty":99.72},{"component":"r3wq1zsx72bz","ninety":100.0,"sixty":100.0,"thirty":100.0},{"component":"354mn7xfxz1h","ninety":99.98,"sixty":99.98,"thirty":99.96},{"component":"3y468xdr1st2","ninety":100.0,"sixty":100.0,"thirty":100.0}];

                        for (var i = 0; i < uptimeValues.length; i++) {
                            setUptimeValue(uptimeValues[i], uptimeKey)
                        }

                        const uptimeLinkVar = document.querySelector('.components-uptime-link > var')
                        if (uptimeLinkVar) {
                            uptimeLinkVar.innerHTML = dayCount;
                        }
                    }
                }

                window.addEventListener('resize', function () {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(function () {
                        resizeSvgViewBoxes();
                    }, delay);
                });

                resizeSvgViewBoxes();
            });
        </script>

        <div id="uptime-tooltip">
            <div class="pointer-container">
                <div class="pointer-larger"></div>
                <div class="pointer-smaller"></div>
            </div>
            <div class="tooltip-box">
                <div class="tooltip-content">
                    <div class="tooltip-close">
                        <i class="fa fa-times"></i>
                    </div>
                    <div class="date"></div>
                    <div class="outages">
                        <div class="outage-field major">
          <span class="label">
            <i class="component-status page-colors text-color major_outage"></i>
            Major outage
          </span>
                            <span class="value-hrs"></span>
                            <span class="value-mins"></span>
                        </div>
                        <div class="outage-field partial">
          <span class="label">
            <i class="component-status page-colors text-color partial_outage"></i>
            Partial outage
          </span>
                            <span class="value-hrs"></span>
                            <span class="value-mins"></span>
                        </div>
                        <div class="no-outages-msg">
                            No downtime recorded on this day.
                        </div>
                        <div class="no-data-msg">
                            No data exists for this day.
                        </div>
                        <div id="major-outage-group-count" class="outage-count">
                            <i class="component-status page-colors text-color major_outage"></i>
                            <span class="count"></span>
                            had a major outage.
                        </div>
                        <div id="partial-outage-group-count" class="outage-count">
                            <i class="component-status page-colors text-color partial_outage"></i>
                            <span class="count"></span>
                            had a partial outage.
                        </div>
                    </div>
                    <div class="related-events">
                        <h3 id="related-event-header">Related</h3>
                        <ul id="related-events-list"></ul>
                    </div>
                    <div class="no-related-msg">
                        <p>No incidents or maintenance related to this downtime.</p>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://dka575ofm4ao0.cloudfront.net/assets/vendor/bowser-1643ca34a6d589b2d4d42163a891e4512d5d7657125e09bb5f3d44288114e6bd.js"></script>
        <script type="text/javascript">
            /**
             This file contains the code needed to handle display of the uptime tooltips on status.
             Note: because it's in ERB, only ES5 syntax is allowed.
             */

            var uptimeData = {"rhznvxg4v7yh":{"component":{"code":"rhznvxg4v7yh","name":"API"},"days":[{"date":"2022-01-05","outages":{},"related_events":[]},{"date":"2022-01-06","outages":{},"related_events":[]},{"date":"2022-01-07","outages":{},"related_events":[]},{"date":"2022-01-08","outages":{},"related_events":[]},{"date":"2022-01-09","outages":{},"related_events":[]},{"date":"2022-01-10","outages":{},"related_events":[]},{"date":"2022-01-11","outages":{},"related_events":[]},{"date":"2022-01-12","outages":{},"related_events":[]},{"date":"2022-01-13","outages":{},"related_events":[]},{"date":"2022-01-14","outages":{},"related_events":[]},{"date":"2022-01-15","outages":{},"related_events":[]},{"date":"2022-01-16","outages":{},"related_events":[]},{"date":"2022-01-17","outages":{},"related_events":[]},{"date":"2022-01-18","outages":{},"related_events":[]},{"date":"2022-01-19","outages":{},"related_events":[]},{"date":"2022-01-20","outages":{},"related_events":[]},{"date":"2022-01-21","outages":{},"related_events":[]},{"date":"2022-01-22","outages":{},"related_events":[]},{"date":"2022-01-23","outages":{},"related_events":[]},{"date":"2022-01-24","outages":{},"related_events":[]},{"date":"2022-01-25","outages":{},"related_events":[]},{"date":"2022-01-26","outages":{"p":1151,"m":8615},"related_events":[{"name":"API Outage","code":"pllv57603svq"},{"name":"Connection and Send Message issues","code":"bcqpwv2cvn06"}]},{"date":"2022-01-27","outages":{},"related_events":[]},{"date":"2022-01-28","outages":{},"related_events":[]},{"date":"2022-01-29","outages":{},"related_events":[]},{"date":"2022-01-30","outages":{},"related_events":[]},{"date":"2022-01-31","outages":{},"related_events":[]},{"date":"2022-02-01","outages":{},"related_events":[]},{"date":"2022-02-02","outages":{},"related_events":[]},{"date":"2022-02-03","outages":{},"related_events":[]},{"date":"2022-02-04","outages":{},"related_events":[]},{"date":"2022-02-05","outages":{},"related_events":[]},{"date":"2022-02-06","outages":{},"related_events":[]},{"date":"2022-02-07","outages":{},"related_events":[]},{"date":"2022-02-08","outages":{},"related_events":[]},{"date":"2022-02-09","outages":{},"related_events":[]},{"date":"2022-02-10","outages":{},"related_events":[]},{"date":"2022-02-11","outages":{},"related_events":[]},{"date":"2022-02-12","outages":{},"related_events":[]},{"date":"2022-02-13","outages":{},"related_events":[]},{"date":"2022-02-14","outages":{},"related_events":[]},{"date":"2022-02-15","outages":{"p":1975},"related_events":[{"name":"Messaging issues","code":"n4njzfn1mqy0"},{"name":"General API and session issues","code":"rn7lfvwzvzvh"}]},{"date":"2022-02-16","outages":{},"related_events":[]},{"date":"2022-02-17","outages":{},"related_events":[]},{"date":"2022-02-18","outages":{},"related_events":[]},{"date":"2022-02-19","outages":{},"related_events":[]},{"date":"2022-02-20","outages":{},"related_events":[]},{"date":"2022-02-21","outages":{},"related_events":[]},{"date":"2022-02-22","outages":{},"related_events":[]},{"date":"2022-02-23","outages":{},"related_events":[]},{"date":"2022-02-24","outages":{},"related_events":[]},{"date":"2022-02-25","outages":{},"related_events":[]},{"date":"2022-02-26","outages":{},"related_events":[]},{"date":"2022-02-27","outages":{},"related_events":[]},{"date":"2022-02-28","outages":{},"related_events":[]},{"date":"2022-03-01","outages":{},"related_events":[{"name":"Asynchronous tasks delayed","code":"b9hppkjmbsz6"}]},{"date":"2022-03-02","outages":{"p":1882},"related_events":[{"name":"Low message send and API availability","code":"qtrlftgt2q1y"}]},{"date":"2022-03-03","outages":{},"related_events":[]},{"date":"2022-03-04","outages":{},"related_events":[{"name":"Discord server \"unavailable\" spikes","code":"6gvvz9w7p58k"},{"name":"Increased latency across Discord","code":"q2zg2chhkjxz"}]},{"date":"2022-03-05","outages":{},"related_events":[{"name":"Discord server \"unavailable\" spikes","code":"6gvvz9w7p58k"}]},{"date":"2022-03-06","outages":{},"related_events":[]},{"date":"2022-03-07","outages":{},"related_events":[]},{"date":"2022-03-08","outages":{"p":3131,"m":5802},"related_events":[{"name":"Increase API Error Rate and Push Error Rate","code":"cjdx9txnrv03"}]},{"date":"2022-03-09","outages":{},"related_events":[]},{"date":"2022-03-10","outages":{},"related_events":[]},{"date":"2022-03-11","outages":{},"related_events":[]},{"date":"2022-03-12","outages":{},"related_events":[{"name":"API Latency and Message Send Issues","code":"7b4bn5hm1656"}]},{"date":"2022-03-13","outages":{},"related_events":[]},{"date":"2022-03-14","outages":{},"related_events":[]},{"date":"2022-03-15","outages":{},"related_events":[]},{"date":"2022-03-16","outages":{},"related_events":[]},{"date":"2022-03-17","outages":{},"related_events":[]},{"date":"2022-03-18","outages":{},"related_events":[]},{"date":"2022-03-19","outages":{},"related_events":[]},{"date":"2022-03-20","outages":{},"related_events":[]},{"date":"2022-03-21","outages":{"p":1736},"related_events":[{"name":"Guild Updates Failing","code":"hf9g6054hg20"}]},{"date":"2022-03-22","outages":{},"related_events":[]},{"date":"2022-03-23","outages":{},"related_events":[]},{"date":"2022-03-24","outages":{},"related_events":[]},{"date":"2022-03-25","outages":{},"related_events":[]},{"date":"2022-03-26","outages":{},"related_events":[]},{"date":"2022-03-27","outages":{},"related_events":[]},{"date":"2022-03-28","outages":{},"related_events":[]},{"date":"2022-03-29","outages":{},"related_events":[]},{"date":"2022-03-30","outages":{},"related_events":[]},{"date":"2022-03-31","outages":{},"related_events":[]},{"date":"2022-04-01","outages":{},"related_events":[]},{"date":"2022-04-02","outages":{},"related_events":[]},{"date":"2022-04-03","outages":{},"related_events":[]},{"date":"2022-04-04","outages":{},"related_events":[]}]},"r3wq1zsx72bz":{"component":{"code":"r3wq1zsx72bz","name":"Media Proxy"},"days":[{"date":"2022-01-05","outages":{},"related_events":[]},{"date":"2022-01-06","outages":{},"related_events":[]},{"date":"2022-01-07","outages":{},"related_events":[]},{"date":"2022-01-08","outages":{},"related_events":[]},{"date":"2022-01-09","outages":{},"related_events":[]},{"date":"2022-01-10","outages":{},"related_events":[]},{"date":"2022-01-11","outages":{},"related_events":[]},{"date":"2022-01-12","outages":{},"related_events":[]},{"date":"2022-01-13","outages":{},"related_events":[]},{"date":"2022-01-14","outages":{},"related_events":[]},{"date":"2022-01-15","outages":{},"related_events":[]},{"date":"2022-01-16","outages":{},"related_events":[]},{"date":"2022-01-17","outages":{},"related_events":[]},{"date":"2022-01-18","outages":{},"related_events":[]},{"date":"2022-01-19","outages":{},"related_events":[]},{"date":"2022-01-20","outages":{},"related_events":[]},{"date":"2022-01-21","outages":{},"related_events":[]},{"date":"2022-01-22","outages":{},"related_events":[]},{"date":"2022-01-23","outages":{},"related_events":[]},{"date":"2022-01-24","outages":{},"related_events":[]},{"date":"2022-01-25","outages":{},"related_events":[]},{"date":"2022-01-26","outages":{},"related_events":[]},{"date":"2022-01-27","outages":{},"related_events":[]},{"date":"2022-01-28","outages":{},"related_events":[]},{"date":"2022-01-29","outages":{},"related_events":[]},{"date":"2022-01-30","outages":{},"related_events":[]},{"date":"2022-01-31","outages":{},"related_events":[]},{"date":"2022-02-01","outages":{},"related_events":[]},{"date":"2022-02-02","outages":{},"related_events":[]},{"date":"2022-02-03","outages":{},"related_events":[]},{"date":"2022-02-04","outages":{},"related_events":[]},{"date":"2022-02-05","outages":{},"related_events":[]},{"date":"2022-02-06","outages":{},"related_events":[]},{"date":"2022-02-07","outages":{},"related_events":[]},{"date":"2022-02-08","outages":{},"related_events":[]},{"date":"2022-02-09","outages":{},"related_events":[]},{"date":"2022-02-10","outages":{},"related_events":[]},{"date":"2022-02-11","outages":{},"related_events":[]},{"date":"2022-02-12","outages":{},"related_events":[]},{"date":"2022-02-13","outages":{},"related_events":[]},{"date":"2022-02-14","outages":{},"related_events":[]},{"date":"2022-02-15","outages":{},"related_events":[]},{"date":"2022-02-16","outages":{},"related_events":[]},{"date":"2022-02-17","outages":{},"related_events":[]},{"date":"2022-02-18","outages":{},"related_events":[]},{"date":"2022-02-19","outages":{},"related_events":[]},{"date":"2022-02-20","outages":{},"related_events":[]},{"date":"2022-02-21","outages":{},"related_events":[]},{"date":"2022-02-22","outages":{},"related_events":[]},{"date":"2022-02-23","outages":{},"related_events":[]},{"date":"2022-02-24","outages":{},"related_events":[]},{"date":"2022-02-25","outages":{},"related_events":[]},{"date":"2022-02-26","outages":{},"related_events":[]},{"date":"2022-02-27","outages":{},"related_events":[]},{"date":"2022-02-28","outages":{},"related_events":[]},{"date":"2022-03-01","outages":{},"related_events":[]},{"date":"2022-03-02","outages":{},"related_events":[]},{"date":"2022-03-03","outages":{},"related_events":[]},{"date":"2022-03-04","outages":{},"related_events":[]},{"date":"2022-03-05","outages":{},"related_events":[]},{"date":"2022-03-06","outages":{},"related_events":[]},{"date":"2022-03-07","outages":{},"related_events":[]},{"date":"2022-03-08","outages":{},"related_events":[]},{"date":"2022-03-09","outages":{},"related_events":[]},{"date":"2022-03-10","outages":{},"related_events":[]},{"date":"2022-03-11","outages":{},"related_events":[]},{"date":"2022-03-12","outages":{},"related_events":[]},{"date":"2022-03-13","outages":{},"related_events":[]},{"date":"2022-03-14","outages":{},"related_events":[]},{"date":"2022-03-15","outages":{},"related_events":[]},{"date":"2022-03-16","outages":{},"related_events":[]},{"date":"2022-03-17","outages":{},"related_events":[]},{"date":"2022-03-18","outages":{},"related_events":[]},{"date":"2022-03-19","outages":{},"related_events":[]},{"date":"2022-03-20","outages":{},"related_events":[]},{"date":"2022-03-21","outages":{},"related_events":[]},{"date":"2022-03-22","outages":{},"related_events":[]},{"date":"2022-03-23","outages":{},"related_events":[]},{"date":"2022-03-24","outages":{},"related_events":[]},{"date":"2022-03-25","outages":{},"related_events":[]},{"date":"2022-03-26","outages":{},"related_events":[]},{"date":"2022-03-27","outages":{},"related_events":[]},{"date":"2022-03-28","outages":{},"related_events":[]},{"date":"2022-03-29","outages":{},"related_events":[]},{"date":"2022-03-30","outages":{},"related_events":[]},{"date":"2022-03-31","outages":{},"related_events":[]},{"date":"2022-04-01","outages":{},"related_events":[]},{"date":"2022-04-02","outages":{},"related_events":[]},{"date":"2022-04-03","outages":{},"related_events":[]},{"date":"2022-04-04","outages":{},"related_events":[]}]},"354mn7xfxz1h":{"component":{"code":"354mn7xfxz1h","name":"Push Notifications"},"days":[{"date":"2022-01-05","outages":{},"related_events":[]},{"date":"2022-01-06","outages":{},"related_events":[]},{"date":"2022-01-07","outages":{},"related_events":[]},{"date":"2022-01-08","outages":{},"related_events":[]},{"date":"2022-01-09","outages":{},"related_events":[]},{"date":"2022-01-10","outages":{},"related_events":[]},{"date":"2022-01-11","outages":{},"related_events":[]},{"date":"2022-01-12","outages":{},"related_events":[]},{"date":"2022-01-13","outages":{},"related_events":[]},{"date":"2022-01-14","outages":{},"related_events":[]},{"date":"2022-01-15","outages":{},"related_events":[]},{"date":"2022-01-16","outages":{},"related_events":[]},{"date":"2022-01-17","outages":{},"related_events":[]},{"date":"2022-01-18","outages":{},"related_events":[]},{"date":"2022-01-19","outages":{},"related_events":[]},{"date":"2022-01-20","outages":{},"related_events":[]},{"date":"2022-01-21","outages":{},"related_events":[]},{"date":"2022-01-22","outages":{},"related_events":[]},{"date":"2022-01-23","outages":{},"related_events":[]},{"date":"2022-01-24","outages":{},"related_events":[]},{"date":"2022-01-25","outages":{},"related_events":[]},{"date":"2022-01-26","outages":{},"related_events":[]},{"date":"2022-01-27","outages":{},"related_events":[]},{"date":"2022-01-28","outages":{},"related_events":[]},{"date":"2022-01-29","outages":{},"related_events":[]},{"date":"2022-01-30","outages":{},"related_events":[]},{"date":"2022-01-31","outages":{},"related_events":[]},{"date":"2022-02-01","outages":{},"related_events":[]},{"date":"2022-02-02","outages":{},"related_events":[]},{"date":"2022-02-03","outages":{},"related_events":[]},{"date":"2022-02-04","outages":{},"related_events":[]},{"date":"2022-02-05","outages":{},"related_events":[]},{"date":"2022-02-06","outages":{},"related_events":[]},{"date":"2022-02-07","outages":{},"related_events":[]},{"date":"2022-02-08","outages":{},"related_events":[]},{"date":"2022-02-09","outages":{},"related_events":[]},{"date":"2022-02-10","outages":{},"related_events":[]},{"date":"2022-02-11","outages":{},"related_events":[]},{"date":"2022-02-12","outages":{},"related_events":[]},{"date":"2022-02-13","outages":{},"related_events":[]},{"date":"2022-02-14","outages":{},"related_events":[]},{"date":"2022-02-15","outages":{},"related_events":[]},{"date":"2022-02-16","outages":{},"related_events":[]},{"date":"2022-02-17","outages":{},"related_events":[]},{"date":"2022-02-18","outages":{},"related_events":[]},{"date":"2022-02-19","outages":{},"related_events":[]},{"date":"2022-02-20","outages":{},"related_events":[]},{"date":"2022-02-21","outages":{},"related_events":[]},{"date":"2022-02-22","outages":{},"related_events":[]},{"date":"2022-02-23","outages":{},"related_events":[]},{"date":"2022-02-24","outages":{},"related_events":[]},{"date":"2022-02-25","outages":{},"related_events":[]},{"date":"2022-02-26","outages":{},"related_events":[]},{"date":"2022-02-27","outages":{},"related_events":[]},{"date":"2022-02-28","outages":{},"related_events":[]},{"date":"2022-03-01","outages":{},"related_events":[]},{"date":"2022-03-02","outages":{},"related_events":[]},{"date":"2022-03-03","outages":{},"related_events":[]},{"date":"2022-03-04","outages":{},"related_events":[]},{"date":"2022-03-05","outages":{},"related_events":[]},{"date":"2022-03-06","outages":{},"related_events":[]},{"date":"2022-03-07","outages":{},"related_events":[]},{"date":"2022-03-08","outages":{"p":3170},"related_events":[{"name":"Increase API Error Rate and Push Error Rate","code":"cjdx9txnrv03"}]},{"date":"2022-03-09","outages":{},"related_events":[]},{"date":"2022-03-10","outages":{},"related_events":[]},{"date":"2022-03-11","outages":{},"related_events":[]},{"date":"2022-03-12","outages":{},"related_events":[]},{"date":"2022-03-13","outages":{},"related_events":[]},{"date":"2022-03-14","outages":{},"related_events":[]},{"date":"2022-03-15","outages":{},"related_events":[]},{"date":"2022-03-16","outages":{},"related_events":[]},{"date":"2022-03-17","outages":{},"related_events":[]},{"date":"2022-03-18","outages":{},"related_events":[]},{"date":"2022-03-19","outages":{},"related_events":[]},{"date":"2022-03-20","outages":{},"related_events":[]},{"date":"2022-03-21","outages":{},"related_events":[]},{"date":"2022-03-22","outages":{},"related_events":[]},{"date":"2022-03-23","outages":{},"related_events":[]},{"date":"2022-03-24","outages":{},"related_events":[]},{"date":"2022-03-25","outages":{},"related_events":[]},{"date":"2022-03-26","outages":{},"related_events":[]},{"date":"2022-03-27","outages":{},"related_events":[]},{"date":"2022-03-28","outages":{},"related_events":[]},{"date":"2022-03-29","outages":{},"related_events":[]},{"date":"2022-03-30","outages":{},"related_events":[]},{"date":"2022-03-31","outages":{},"related_events":[]},{"date":"2022-04-01","outages":{},"related_events":[]},{"date":"2022-04-02","outages":{},"related_events":[]},{"date":"2022-04-03","outages":{},"related_events":[]},{"date":"2022-04-04","outages":{},"related_events":[]}]},"3y468xdr1st2":{"component":{"code":"3y468xdr1st2","name":"Search","startDate":"2020-11-10"},"days":[{"date":"2022-01-05","outages":{},"related_events":[]},{"date":"2022-01-06","outages":{},"related_events":[]},{"date":"2022-01-07","outages":{},"related_events":[]},{"date":"2022-01-08","outages":{},"related_events":[]},{"date":"2022-01-09","outages":{},"related_events":[]},{"date":"2022-01-10","outages":{},"related_events":[]},{"date":"2022-01-11","outages":{},"related_events":[{"name":"Search message indexing behind","code":"ncgz6tlbl5jb"}]},{"date":"2022-01-12","outages":{},"related_events":[]},{"date":"2022-01-13","outages":{},"related_events":[]},{"date":"2022-01-14","outages":{},"related_events":[]},{"date":"2022-01-15","outages":{},"related_events":[]},{"date":"2022-01-16","outages":{},"related_events":[]},{"date":"2022-01-17","outages":{},"related_events":[]},{"date":"2022-01-18","outages":{},"related_events":[]},{"date":"2022-01-19","outages":{},"related_events":[]},{"date":"2022-01-20","outages":{},"related_events":[]},{"date":"2022-01-21","outages":{},"related_events":[]},{"date":"2022-01-22","outages":{},"related_events":[]},{"date":"2022-01-23","outages":{},"related_events":[]},{"date":"2022-01-24","outages":{},"related_events":[]},{"date":"2022-01-25","outages":{},"related_events":[]},{"date":"2022-01-26","outages":{},"related_events":[{"name":"Search issues","code":"cbrtv3whq4x8"}]},{"date":"2022-01-27","outages":{},"related_events":[]},{"date":"2022-01-28","outages":{},"related_events":[]},{"date":"2022-01-29","outages":{},"related_events":[]},{"date":"2022-01-30","outages":{},"related_events":[]},{"date":"2022-01-31","outages":{},"related_events":[]},{"date":"2022-02-01","outages":{},"related_events":[]},{"date":"2022-02-02","outages":{},"related_events":[]},{"date":"2022-02-03","outages":{},"related_events":[]},{"date":"2022-02-04","outages":{},"related_events":[]},{"date":"2022-02-05","outages":{},"related_events":[]},{"date":"2022-02-06","outages":{},"related_events":[]},{"date":"2022-02-07","outages":{},"related_events":[]},{"date":"2022-02-08","outages":{},"related_events":[]},{"date":"2022-02-09","outages":{},"related_events":[]},{"date":"2022-02-10","outages":{},"related_events":[]},{"date":"2022-02-11","outages":{},"related_events":[]},{"date":"2022-02-12","outages":{},"related_events":[]},{"date":"2022-02-13","outages":{},"related_events":[]},{"date":"2022-02-14","outages":{},"related_events":[]},{"date":"2022-02-15","outages":{},"related_events":[]},{"date":"2022-02-16","outages":{},"related_events":[]},{"date":"2022-02-17","outages":{},"related_events":[]},{"date":"2022-02-18","outages":{},"related_events":[]},{"date":"2022-02-19","outages":{},"related_events":[]},{"date":"2022-02-20","outages":{},"related_events":[]},{"date":"2022-02-21","outages":{},"related_events":[]},{"date":"2022-02-22","outages":{},"related_events":[]},{"date":"2022-02-23","outages":{},"related_events":[]},{"date":"2022-02-24","outages":{},"related_events":[]},{"date":"2022-02-25","outages":{},"related_events":[]},{"date":"2022-02-26","outages":{},"related_events":[]},{"date":"2022-02-27","outages":{},"related_events":[]},{"date":"2022-02-28","outages":{},"related_events":[]},{"date":"2022-03-01","outages":{},"related_events":[]},{"date":"2022-03-02","outages":{},"related_events":[]},{"date":"2022-03-03","outages":{},"related_events":[]},{"date":"2022-03-04","outages":{},"related_events":[]},{"date":"2022-03-05","outages":{},"related_events":[]},{"date":"2022-03-06","outages":{},"related_events":[]},{"date":"2022-03-07","outages":{},"related_events":[]},{"date":"2022-03-08","outages":{},"related_events":[]},{"date":"2022-03-09","outages":{},"related_events":[]},{"date":"2022-03-10","outages":{},"related_events":[]},{"date":"2022-03-11","outages":{},"related_events":[]},{"date":"2022-03-12","outages":{},"related_events":[]},{"date":"2022-03-13","outages":{},"related_events":[]},{"date":"2022-03-14","outages":{},"related_events":[]},{"date":"2022-03-15","outages":{},"related_events":[]},{"date":"2022-03-16","outages":{},"related_events":[]},{"date":"2022-03-17","outages":{},"related_events":[]},{"date":"2022-03-18","outages":{},"related_events":[]},{"date":"2022-03-19","outages":{},"related_events":[]},{"date":"2022-03-20","outages":{},"related_events":[]},{"date":"2022-03-21","outages":{},"related_events":[]},{"date":"2022-03-22","outages":{},"related_events":[]},{"date":"2022-03-23","outages":{},"related_events":[]},{"date":"2022-03-24","outages":{},"related_events":[]},{"date":"2022-03-25","outages":{},"related_events":[]},{"date":"2022-03-26","outages":{},"related_events":[]},{"date":"2022-03-27","outages":{},"related_events":[]},{"date":"2022-03-28","outages":{},"related_events":[]},{"date":"2022-03-29","outages":{},"related_events":[]},{"date":"2022-03-30","outages":{},"related_events":[]},{"date":"2022-03-31","outages":{},"related_events":[]},{"date":"2022-04-01","outages":{},"related_events":[]},{"date":"2022-04-02","outages":{},"related_events":[]},{"date":"2022-04-03","outages":{},"related_events":[]},{"date":"2022-04-04","outages":{},"related_events":[]}]}}
            var timeoutId;
            var monthStrings = [
                'Jan', 'Feb', 'Mar',
                'Apr', 'May', 'Jun',
                'Jul', 'Aug', 'Sep',
                'Oct', 'Nov', 'Dec'
            ];
            var EVENT_MAX_LENGTH = 90;

            // Detect device (desktop vs. touch device)
            function touchDevice() {
                var browser = bowser.getParser(window.navigator.userAgent);
                // if type is either mobile or tablet, return true
                return browser.parse().parsedResult.platform.type !== 'desktop';
            }

            // Class is in format day-<number>. Convert to just number
            function dayNumberFromClass(className) {
                return parseInt(className.split('-')[1]);
            }

            // Class is in format component-<code>. Convert to just code
            function componentCodeFromClass(className) {
                return className.split('-')[1];
            }

            // Convert number to string pixel measurement
            function intToPixels(number) {
                return number.toString() + 'px';
            }

            function truncate(str) {
                return str.substring(0, EVENT_MAX_LENGTH) +
                    (str.length > EVENT_MAX_LENGTH ? '...' : '');
            }

            // Tooltip Handling class constructor
            function UptimeTooltipHandler(frameWidth) {
                this.visible = false;
                this.activeDay = {
                    hovered: false
                };
                this.tooltip = document.getElementById('uptime-tooltip');
                this.frameWidth = frameWidth === undefined ? window.innerWidth : frameWidth;
                this.scrolling = false;

                window.addEventListener('mousemove', this.tooltipListener.bind(this));
                window.addEventListener('orientationchange', this.orientationListener.bind(this));

                // on tooltip creation, determine whether to display touch-specific controls
                var tooltipCloseButton = document.querySelector('.tooltip-close');

                if (touchDevice()) {
                    var componentsContainer = document.querySelector('.components-container');
                    componentsContainer.addEventListener('touchstart', this.handleTouch.bind(this));

                    tooltipCloseButton.addEventListener('touchstart', this.unhoverTooltip.bind(this));
                } else {
                    window.addEventListener('resize', this.resizeListener.bind(this));
                    // classList not supported by IE < 9
                    tooltipCloseButton.className += ' hidden';
                }

                // Handle toggle of group elements
                var groupComponents = document.querySelectorAll('[data-js-hook=component-group-opener]');
                for (var i = 0; i < groupComponents.length; i++) {
                    groupComponents[i].addEventListener('click', this.hideTooltip.bind(this));
                }

                var tooltipBox = document.querySelector('#uptime-tooltip .tooltip-box');
                tooltipBox.addEventListener('mouseenter', this.mouseEnteredTooltip.bind(this));
                tooltipBox.addEventListener('mouseleave', this.unhoverTooltip.bind(this));
            }

            UptimeTooltipHandler.prototype.tooltipListener = function(event) {
                if (!this.tooltipHovered) {
                    this.updateHoveredDay(event);
                    this.updateTooltip(event);
                }
            }

            // this handler will accommodate for mobile orientation change
            UptimeTooltipHandler.prototype.orientationListener = function(event) {
                // just close the tooltip
                this.unhoverTooltip();
            }

            UptimeTooltipHandler.prototype.resizeListener = function(event) {
                this.frameWidth = window.innerWidth;
            }

            UptimeTooltipHandler.prototype.handleTouch = function (event) {
                if (event.target.classList.contains('uptime-day')) {
                    event.stopPropagation();
                    this.bladeTouched(event);
                }
            }

            UptimeTooltipHandler.prototype.mouseEnteredTooltip = function() {
                // Necessary to clear the timeout set for closing the tooltip when the mouse
                // moves off the blade or timeline, so the tooltip isnt closed on hover
                clearTimeout(timeoutId);
                // Sets it to null so the timeout can be set later, as clearTimeout only
                // cancels the timer, and we need to allow it to be reset in the mouse
                // move handler below
                timeoutId = null;
                this.tooltipHovered = true;
            }

            UptimeTooltipHandler.prototype.unhoverTooltip = function() {
                this.tooltipHovered = false;
                this.activeDay.hovered = false;
                this.hideTooltip();
            }

            UptimeTooltipHandler.prototype.bladeTouched = function (event) {
                event.preventDefault();
                var classes = event.target.getAttribute('class').split(' ');
                var componentCode = componentCodeFromClass(classes[1])
                var index = dayNumberFromClass(classes[2]);

                // If open and tapped on same component and day, close tooltip
                if (this.visible && this.activeDay.component === componentCode && this.activeDay.index === index) {
                    this.hideTooltip();
                } else {
                    this.updateHoveredDay(event);
                    this.updateTooltip(event);
                }
            }

            UptimeTooltipHandler.prototype.updateHoveredDay = function(event) {
                var classes = event.target.getAttribute('class'); // classList doesn't work in IE
                var onDay = classes != null && classes.split(' ').indexOf('uptime-day') !== -1;

                if (onDay) {
                    classes = classes.split(' ');

                    var componentCode = componentCodeFromClass(classes[1]);

                    this.activeDay = {
                        index: dayNumberFromClass(classes[2]),
                        component: componentCode,
                        bounds: event.target.getBoundingClientRect(),
                        isGroup: uptimeData[componentCode].component.isGroup,
                        hovered: true
                    }
                } else {
                    this.activeDay.hovered = false;
                }
            }

            UptimeTooltipHandler.prototype.updateTooltip = function(event) {
                var classes = event.target.getAttribute('class'); // classList doesn't work in IE
                var hoveredOnGraphic = classes != null && classes.split(' ').indexOf('availability-time-line-graphic') !== -1;

                if (this.activeDay.hovered) {
                    this.updateTooltipData();
                    this.positionTooltip();
                } else if (this.visible && !this.activeDay.hovered && !hoveredOnGraphic) {
                    // Important: since this is on mouse move it will be called multiple times
                    // which will clear timeoutId and reset it to the new value, meaning
                    // it is a race condition to cancel it
                    if (!timeoutId) {
                        var _this = this;
                        timeoutId = setTimeout(function() {
                            _this.hideTooltip();
                            timeoutId = null;
                        }, 250);
                    }
                }
            }

            UptimeTooltipHandler.prototype.updateTooltipData = function() {
                // Get the data for the day we're hovered on
                var day = uptimeData[this.activeDay.component].days[this.activeDay.index];

                // Update the date for the tooltip
                var date = new Date(day.date);

                // Get the component's start date.  Note that it will be undefined here unless it is populated in our database
                var startDay = uptimeData[this.activeDay.component].component.startDate;
                var startDate = startDay ? new Date(startDay) : null;

                // Determine whether current date falls before component's start date.
                var beforeStartDate = startDate ? date.getTime() < startDate.getTime() : false;

                // UTC necessary since days are passed yyyy-mm-dd, and new Date uses midnight UTC, so local times
                // are presented as the day before
                var dateString = date.getUTCDate() + " " + monthStrings[date.getUTCMonth()] + " " + date.getUTCFullYear();
                document.querySelector('#uptime-tooltip .date').innerHTML = dateString;

                // Update the outage fields
                if (this.activeDay.isGroup) {
                    this.updateGroupOutageFields()
                } else {
                    this.updateOutageFields(day.outages.p, day.outages.m, day.related_events, beforeStartDate);
                }
            }

            UptimeTooltipHandler.prototype.hoursFromSeconds = function(s) {
                return Math.floor(s / 3600);
            }

            UptimeTooltipHandler.prototype.minutesFromSeconds = function(s) {
                // If less than a minute, round up to 1 minute to show that some outage existed
                if (s > 0 && s < 60) {
                    return 1;
                }

                // Otherwise use floor
                return Math.floor((s % 3600) / 60);
            }

            UptimeTooltipHandler.prototype.updateGroupOutageFields = function() {
                // Hide time info
                document.querySelector('#uptime-tooltip .outage-field.major').style.display = 'none';
                document.querySelector('#uptime-tooltip .outage-field.partial').style.display = 'none';
                document.querySelector(".related-events h3").style.display = 'none';
                document.querySelector('.no-related-msg').style.display = 'none';

                var eventList = document.getElementById("related-events-list")
                var cloneList = eventList.cloneNode(false);
                eventList.parentNode.replaceChild(cloneList, eventList);

                var partialCount = 0;
                var majorCount = 0;

                /**
                 We were originally using the operationalCount as part of the no outage copy for group components,
                 but ultimately decided not to use it. I opted to leave the variable in place in case we ever
                 decide to use it in the future.
                 */
                var operationalCount = 0;
                var noDataCount = 0;
                var showcasedComponentsCount = 0;

                var components = uptimeData[this.activeDay.component].component.group

                for (var i = 0; i < components.length; i++) {
                    if (!uptimeData[components[i]]) continue;

                    showcasedComponentsCount++;

                    var outages = uptimeData[components[i]].days[this.activeDay.index].outages;

                    var currentDay = uptimeData[components[i]].days[this.activeDay.index];
                    var currentDate = new Date(currentDay.date);

                    // Get the component's start date.  Note that it will be undefined here unless it is populated in our database
                    var startDay = uptimeData[components[i]].component.startDate;
                    var startDate = startDay ? new Date(startDay) : null;

                    if (outages.p) {
                        partialCount += 1;
                    }

                    if (outages.m) {
                        majorCount += 1;
                    }

                    // Only increase operational count if component has data for this day
                    if (!outages.p && !outages.m) {
                        if (startDate && currentDate.getTime() < startDate.getTime()) {
                            noDataCount +=1;
                        }
                        else {
                            operationalCount +=1;
                        }
                    }
                }

                document.querySelector('#major-outage-group-count').style.display = majorCount ? 'block' : 'none';
                document.querySelector('#partial-outage-group-count').style.display = partialCount ? 'block' : 'none';

                document.querySelector('#major-outage-group-count .count').innerText = majorCount + (majorCount === 1 ? " component" : " components");
                document.querySelector('#partial-outage-group-count .count').innerText = partialCount + (partialCount === 1 ? " component" : " components ");

                // Show no data message only if we do not have data for any showcased components in the group
                var showNoDataMessage = noDataCount === showcasedComponentsCount;

                // Show no outages message if we have data for the components and no outages in that data
                document.querySelector('#uptime-tooltip .no-outages-msg').style.display = (majorCount || partialCount || showNoDataMessage) ? 'none' : 'block';
                document.querySelector('#uptime-tooltip .no-data-msg').style.display = showNoDataMessage ? 'block' : 'none';
            }

            UptimeTooltipHandler.prototype.updateOutageFields = function(partial, major, relatedEvents, beforeStartDate) {
                // Hide group info
                document.querySelector('#major-outage-group-count').style.display = 'none';
                document.querySelector('#partial-outage-group-count').style.display = 'none';

                // Show the message that no outage present, if none is present
                if (partial || major || beforeStartDate) {
                    document.querySelector('#uptime-tooltip .no-outages-msg').style.display = 'none';
                } else {
                    document.querySelector('#uptime-tooltip .no-outages-msg').style.display = 'block';
                }

                if (beforeStartDate) {
                    document.querySelector('#uptime-tooltip .no-data-msg').style.display = 'block';
                }
                else {
                    document.querySelector('#uptime-tooltip .no-data-msg').style.display = 'none';
                }

                // Update partial outage field if an outage exists, otherwise hide it
                if (partial) {
                    var hrs = this.hoursFromSeconds(partial);
                    var mins = this.minutesFromSeconds(partial);
                    document.querySelector('#uptime-tooltip .outage-field.partial .value-hrs').innerHTML = hrs.toString() + ' hrs';
                    document.querySelector('#uptime-tooltip .outage-field.partial .value-mins').innerHTML = mins.toString() + ' mins';
                    document.querySelector('#uptime-tooltip .outage-field.partial').style.display = 'flex';
                } else {
                    document.querySelector('#uptime-tooltip .outage-field.partial').style.display = 'none';
                }

                // Update major outage field if an outage exists, otherwise hide it
                if (major) {
                    var hrs = this.hoursFromSeconds(major);
                    var mins = this.minutesFromSeconds(major);
                    document.querySelector('#uptime-tooltip .outage-field.major .value-hrs').innerHTML = hrs.toString() + ' hrs';
                    document.querySelector('#uptime-tooltip .outage-field.major .value-mins').innerHTML = mins.toString() + ' mins';
                    document.querySelector('#uptime-tooltip .outage-field.major').style.display = 'flex';
                } else {
                    document.querySelector('#uptime-tooltip .outage-field.major').style.display = 'none';
                }

                var eventList = document.getElementById("related-events-list")
                var cloneList = eventList.cloneNode(false);
                document.querySelector(".related-events h3").style.display = (relatedEvents.length ? 'block' : 'none');

                for (var i = 0; i < relatedEvents.length; i++) {
                    var listItem = document.createElement("li");
                    listItem.className = "related-event";
                    var anchor = document.createElement("a");
                    anchor.className = "related-event-link";
                    anchor.target = "_blank";
                    anchor.href = window.Routes.incident_path(relatedEvents[i].code);


                    var text = document.createTextNode(truncate(relatedEvents[i].name));
                    anchor.appendChild(text);
                    listItem.appendChild(anchor);
                    cloneList.appendChild(listItem);
                }

                const displayNoRelatedMsg = ((major || partial) && !relatedEvents.length);
                document.querySelector('.no-related-msg').style.display = (displayNoRelatedMsg ? 'block' : 'none');

                eventList.parentNode.replaceChild(cloneList, eventList);
            }

            UptimeTooltipHandler.prototype.positionTooltip = function() {
                this.calculatePointerCenter();
                this.calculateBoxPosition();

                // show tooltip
                this.tooltip.style.display = 'block';

                // position pointer
                var pointer = this.tooltip.getElementsByClassName('pointer-container')[0];
                pointer.style.left = intToPixels(this.pointerCenter.x - 8);
                pointer.style.top = intToPixels(this.pointerCenter.y - 5);

                // position display box
                var box = this.tooltip.getElementsByClassName('tooltip-box')[0];
                box.style.left = intToPixels(this.boxLeft);
                box.style.top = intToPixels(this.pointerCenter.y + 5);

                this.visible = true;
            }

            UptimeTooltipHandler.prototype.calculatePointerCenter = function() {
                var bounds = this.activeDay.bounds;
                var rectLeft = bounds.left + window.pageXOffset;
                var rectBottom = bounds.bottom + window.pageYOffset;
                var rectWidth = bounds.right - bounds.left;

                this.pointerCenter = {
                    x: rectLeft + Math.floor(rectWidth / 2),
                    y: rectBottom + 5
                }
            }

            UptimeTooltipHandler.prototype.calculateBoxPosition = function() {
                var sideWidth = 162.5;
                if (this.pointerCenter.x - sideWidth < 0) {
                    this.boxLeft = 0;
                } else if (this.pointerCenter.x + sideWidth > this.frameWidth) {
                    this.boxLeft = this.frameWidth - sideWidth * 2;
                } else {
                    this.boxLeft = this.pointerCenter.x - sideWidth;
                }
            }

            UptimeTooltipHandler.prototype.hideTooltip = function() {
                this.tooltip.style.display = 'none';
                this.visible = false;
            }

            new UptimeTooltipHandler();

        </script>


        <div class="incidents-list format-expanded">
            <a class="font-largest no-link" id="past-incidents" href="#past-incidents">Past Incidents</a>

            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Apr <var data-var="date"> 4</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported today.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Apr <var data-var="date"> 3</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Apr <var data-var="date"> 2</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Apr <var data-var="date"> 1</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">31</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular ">
                <div class="date border-color font-large">Mar <var data-var="date">30</var>, <var data-var="year">2022</var></div>
                <div class="incident-container">
                    <div class="incident-title impact-none font-large">
                        <a href="/incidents/12pdcqxxtc7g">API Availability Issues</a>
                    </div>

                    <div class="updates-container">
                        <!-- postmortem -->

                        <!-- incident updates -->
                        <div class="update font-regular resolved">
                            <strong>Resolved</strong> -
                            Service should be recovered now. We're aware of the root cause, and the issue should not recur.

                            <br>

                            <small>
                                Mar <var data-var='date'>30</var>, <var data-var='time'>14:35</var> PDT
                            </small>
                        </div>
                        <div class="update font-regular investigating">
                            <strong>Investigating</strong> -
                            We're currently investigating message send / connection difficulties.

                            <br>

                            <small>
                                Mar <var data-var='date'>30</var>, <var data-var='time'>14:24</var> PDT
                            </small>
                        </div>
                    </div>

                </div>

            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">29</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">28</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">27</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">26</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">25</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular ">
                <div class="date border-color font-large">Mar <var data-var="date">24</var>, <var data-var="year">2022</var></div>
                <div class="incident-container">
                    <div class="incident-title impact-none font-large">
                        <a href="/incidents/45xsp0xvb8q8">Member Lists In Very Large Guilds</a>
                    </div>

                    <div class="updates-container">
                        <!-- postmortem -->

                        <!-- incident updates -->
                        <div class="update font-regular resolved">
                            <strong>Resolved</strong> -
                            We've identified the issue and applied a fix. Member lists should be back to normal.

                            <br>

                            <small>
                                Mar <var data-var='date'>24</var>, <var data-var='time'>23:34</var> PDT
                            </small>
                        </div>
                        <div class="update font-regular investigating">
                            <strong>Investigating</strong> -
                            We're investigating an issue affecting member lists in very large guilds (> 75,000 members). The sidebar of online members may be degraded or missing.

                            <br>

                            <small>
                                Mar <var data-var='date'>24</var>, <var data-var='time'>22:16</var> PDT
                            </small>
                        </div>
                    </div>

                </div>

            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">23</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular no-incidents">
                <div class="date border-color font-large">Mar <var data-var="date">22</var>, <var data-var="year">2022</var></div>
                <p class="color-secondary">No incidents reported.</p>
            </div>


            <div class="status-day font-regular ">
                <div class="date border-color font-large">Mar <var data-var="date">21</var>, <var data-var="year">2022</var></div>
                <div class="incident-container">
                    <div class="incident-title impact-major font-large">
                        <a href="/incidents/hf9g6054hg20">Guild Updates Failing</a>
                    </div>

                    <div class="updates-container">
                        <!-- postmortem -->

                        <!-- incident updates -->
                        <div class="update font-regular resolved">
                            <strong>Resolved</strong> -
                            This incident has been resolved.

                            <br>

                            <small>
                                Mar <var data-var='date'>21</var>, <var data-var='time'>15:40</var> PDT
                            </small>
                        </div>
                        <div class="update font-regular identified">
                            <strong>Identified</strong> -
                            A software update resulted in changes to non-discoverable servers to fail. We are rolling back the change now and expect to resolve this in the next 45 minutes.

                            <br>

                            <small>
                                Mar <var data-var='date'>21</var>, <var data-var='time'>15:11</var> PDT
                            </small>
                        </div>
                    </div>

                </div>

            </div>

        </div>


        <div class="page-footer border-color font-small">
            <a href="/history" class="history-footer-link"><span style="font-family:arial">&larr;</span> Incident History</a>

            <span class="color-secondary powered-by"><a class="color-secondary" href="https://github.com/HSE-CyberSecurity-Team">Powered by hORIzON Team</a></span>
        </div>
    </div>
</div>


</div>



<!-- custom metrics stuff -->


</script>
<script src="https://dka575ofm4ao0.cloudfront.net/assets/status_common-c71dfacc6ab11ce212c0127e73cb0bae84e2856d83c17739bebb5e11a970e857.js"></script>
<script>
    SP.pollForChanges('/api/v2/status.json');
</script>

<script>
    $(function() {
        $('.tool').tooltipster({
            animationDuration: 100,
            contentAsHTML: true,
            delay: 100,
            theme: 'tooltipster-borderless',
            functionInit: function (instance, helper) {
                var $origin = $(helper.origin),
                    dataOptions = $origin.attr('data-tooltip-config');
                if (dataOptions){
                    dataOptions = JSON.parse(dataOptions);
                    $.each(dataOptions, function(name, option){
                        instance.option(name, option);
                    });
                }
            }
        });
        // clicks on first tab in subscribe popout since we won't know which is first
        // upon construction in the ruby code
        $('.updates-dropdown-nav > a').eq(0).click();

        // twitter follow button needs some margin
        $('.twitter-follow-button').css('margin-right', '6px');
    });

    $(function() {
        // open/close component groups
        HRB.utils.djshook('component-group-opener').on('click', function() {
            var groupParentIndicator = $(this).find('.group-parent-indicator');
            groupParentIndicator.toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o').end().parent().toggleClass('open');
            toggleGroup(groupParentIndicator)
        });
    });

    $(function() {
        HRB.utils.djshook('component-group-opener').on('keydown', function(event) {
            if (event.key !== "Enter" && event.key !== " ") {
                return;
            }
            event.preventDefault()
            var groupParentIndicator = $(this).find('.group-parent-indicator');
            groupParentIndicator.toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o').end().parent().toggleClass('open');
            toggleGroup(groupParentIndicator)
        });
    });

    function toggleGroup(groupParentIndicator) {
        var isOpen = groupParentIndicator.attr('aria-expanded')
        if (isOpen == 'false') {
            groupParentIndicator.attr('aria-expanded', 'true');
        } else {
            groupParentIndicator.attr('aria-expanded', 'false');
        }
    }

    $(function() {
        $(document).on('ajax:complete', '.modal.in', function(e) {
            // Close the active modal.
            $('.modal.in').modal('hide');
        });
    });

</script>
<script src="https://dka575ofm4ao0.cloudfront.net/assets/vendor/highstock.min-9de8c325692300efdf4b01e93caaa5668693434b74882c25c3b13d58b2d583cb.js"></script>

<script>
    //<![CDATA[
    String.prototype.commafy = function () {
        return this.replace(/(^|[^\w.])(\d{4,})/g, function($0, $1, $2) {
            return $1 + $2.replace(/\d(?=(?:\d\d\d)+(?!\d))/g, "$&,");
        });
    }

    Number.prototype.commafy = function () {
        return String(this).commafy();
    }

    $(function() {
        SP.currentPage.numberToDecimalPlaces = function(num, dec) {
            if (dec == 0) {
                return Math.round(num).commafy();
            }

            newnum = num.toFixed(dec)
            var finalValue;

            // this gets rid of the 100.000% thing
            if (num == parseInt(newnum))
                finalValue = Math.round(num);
            else
                finalValue = newnum;

            return finalValue.commafy();
        }

        SP.currentPage.getDataForTimePeriod = function(period) {
            $.ajax({
                type: "GET",
                // this line must be end up with "//status.*" type of URLs (no protocol, just leading slashes). customers use SSL through us or by offloading with
                // cloudflare or something like it and the request.protocol the server sees is different than what the browser sees
                url: "//discordstatus.com/metrics-display/5k2rt9f7pmny/_.json".replace('_', period)
            }).done(function(metricsDisplay, textStatus, xhr) {
                var summary = metricsDisplay.summary
                    , $metricSummaryLabel = HRB.utils.djshook('metrics-display-current-5k2rt9f7pmny')
                    , $graphContainer = HRB.utils.djshook('metrics-display-graph-container-5k2rt9f7pmny');
                var errorMsg = null;

                if(summary === "unavailable") {
                    errorMsg = 'We\'re having issues retrieving data for <strong>API Response Time</strong>.</div>';
                } else if(summary) {
                    // we need to do a basic check to make sure we have any data at all
                    var hasDataRollupsAvailable = false;
                    for(var h = 0; h < metricsDisplay.metrics.length; h++) {
                        if(metricsDisplay.metrics[h].data.length > 0) {
                            hasDataRollupsAvailable = true;
                            break;
                        }
                    }
                    if(!hasDataRollupsAvailable) {
                        errorMsg = "Oops! No data has been indexed for <strong>API Response Time</strong> for this time period yet.";
                    }
                } else {
                    errorMsg = "Failed to load. <strong>API Response Time</strong>";
                }

                if(errorMsg !== null) {
                    $metricSummaryLabel.text("--"); // display -- instead of number
                    $graphContainer.html('<div class="small"  style="text-align:center;">' + errorMsg + '</div>'); // removed .parent().find('.metric-meta').remove() so name still shows
                    $graphContainer.removeAttr("style");
                    return;
                }

                $graphContainer.show();
                $graphContainer.attr("style", "height: 120px"); // set style after error message removed it
                // proceed since we have data
                $metricSummaryLabel.text(SP.currentPage.numberToDecimalPlaces(summary['mean'], 0 ) + ' ms');

                var metricDataPoints = {}
                    , intervalMsec = metricsDisplay.period.interval * 1000;

                var startingBucketMsec = parseInt((new Date()).getTime() / intervalMsec) * intervalMsec;

                for(var h = 0; h < metricsDisplay.metrics.length; h++) {
                    metricDataPoints[metricsDisplay.metrics[h].metric.id] = []
                    var data = metricsDisplay.metrics[h].data
                        , currentBucketMsec = startingBucketMsec;

                    for(var i = metricsDisplay.period.count; i > 0; i--) {
                        // loop over the data and pull out the data point with the following characteristics
                        //  -> closest to currentBucketMsec
                        //  -> without being greater than currentMsecBucket
                        //  -> without being more than 1 intervalMsec bucket away
                        var valueToUse = null;
                        for(var j = data.length - 1; j >= 0; j--) {
                            var currentTimestampMsec = data[j].timestamp * 1000;
                            if(currentTimestampMsec <= currentBucketMsec && currentTimestampMsec > (currentBucketMsec - intervalMsec)) {
                                valueToUse = data[j].value;
                                // console.log("Using ts:" + currentTimestampMsec + " with value:" + valueToUse + " for bucket:" + currentBucketMsec);
                                break;
                            }
                        }

                        // local time
                        var offset = -1 * (new Date()).getTimezoneOffset() * 60 * 1000;

                        metricDataPoints[metricsDisplay.metrics[h].metric.id].push([currentBucketMsec + offset, valueToUse])
                        currentBucketMsec -= intervalMsec;
                    }

                    metricDataPoints[metricsDisplay.metrics[h].metric.id].reverse();
                }

                // set Global options
                Highcharts.setOptions({
                    lang: {
                        thousandsSep: ','
                    }
                });

                $('#metrics-display-graph-container-5k2rt9f7pmny').highcharts('StockChart', {
                    plotOptions : {
                        series : {
                            animation : false,
                            color : '#5865F2',
                            connectNulls: false
                        },
                    },

                    chart : {
                        backgroundColor: '#FFFFFF'
                    },

                    title : {
                        text: '',
                        style: {
                            display: 'none',
                        }
                    },

                    credits : {
                        enabled : false
                    },

                    exporting : {
                        enabled : false
                    },

                    rangeSelector : {
                        enabled : false
                    },

                    scrollbar : {
                        enabled : false
                    },

                    navigator : {
                        enabled : false
                    },

                    xAxis: {
                        gridLineColor : 'rgba(224,224,224,.8)',
                        labels: {
                            style : {
                                color: '#72767D'
                            }
                        },
                        lineColor: '#E0E0E0',
                    },

                    yAxis: {
                        gridLineColor : 'rgba(224,224,224,.5)',
                        labels: {
                            align: 'left',
                            x: 5,
                            y: 3,
                            style : {
                                color: '#72767D'
                            },
                            enabled : true
                        },
                        showLastLabel: true,
                        tickPixelInterval: 40,

                    },

                    series : [
                        {
                            name : 'API Response Time',
                            data : metricDataPoints['pbb6x1yjh8s3'],
                            tooltip: {
                                valueSuffix: ' ms'
                            },
                            enableMouseTracking : ($(window).outerWidth() > 480) && true
                        }

                    ],

                    tooltip: {
                        borderWidth: 0,
                        enabled: ($(window).outerWidth() > 480) && true,
                        headerFormat: "<span style='font-size: 10px'>{point.key}  </span>",
                        hideDelay: 300,
                        pointFormat: "<span style='color:{point.color}'>●</span>  <b>{point.y}</b><br/>",
                        positioner: function() { return {x: 0, y: 0 }; },
                        shadow: false,
                        shape: "square",
                        split: false
                    }
                });

            });
        }

        var $timePeriodToggles = HRB.utils.djshook('data-time-period-toggle');

        SP.currentPage.activeTimePeriodToggle = function(period) {
            $timePeriodToggles.removeClass('active');
            $timePeriodToggles.filter('[data-time-period="' + period + '"]').addClass('active');
        }

        SP.currentPage.getAndDisplayInitialChartData = function() {
            if (window.location.hash == '#week') {
                SP.currentPage.getDataForTimePeriod('week');
                SP.currentPage.activeTimePeriodToggle('week');
            }
            else if (window.location.hash == '#month') {
                SP.currentPage.getDataForTimePeriod('month');
                SP.currentPage.activeTimePeriodToggle('month');
            }
            else {
                SP.currentPage.getDataForTimePeriod('day');
                SP.currentPage.activeTimePeriodToggle('day');
            }
        }

        $timePeriodToggles.on('click', function() {
            var newPeriod = $(this).attr('data-time-period');

            SP.currentPage.activeTimePeriodToggle(newPeriod);
            SP.currentPage.getDataForTimePeriod(newPeriod);
            window.location.hash = newPeriod;

            return false;
        });

        SP.currentPage.getAndDisplayInitialChartData();
    })
    //]]>
</script>

</body>
</html>